\begin{figure}
\begin{center}
\begin{tikzpicture}
	\tikzstyle{simdbox}=[minimum height = 1cm, minimum width = 0.6cm,right=10mm, rectangle, draw=black, fill=color0]
	\tikzstyle{scalarbox}=[simdbox, minimum width = 0.25cm, inner sep=0cm]
	\tikzstyle{boundingbox}=[draw=black, thick, rounded corners, inner sep=0.2cm]

	\node[right=10mm] (sched-label) at (0.5cm, 2.5cm) {Scheduler};
	\node[simdbox, minimum height=0.25cm] (sched0) at (1cm, 2cm) {};
	\node[simdbox, fill=color1, minimum height=0.25cm] (sched1) at (1cm, 1.75cm) {};
	\node[simdbox, fill=color2, minimum height=0.25cm] (sched2) at (1cm, 1.5cm) {};
	\node[simdbox, fill=color3, minimum height=0.25cm] (sched3) at (1cm, 1.25cm) {};
	\node[simdbox, dotted, minimum height=0.25cm, fill=color0!30!white, scope fading=south]
		(sched4) at (1cm, 1cm) {};

	\node[right=10mm] (mark0) at (-1cm, 2.5cm) {};
	\node (mark1) at (4.3cm + 3cm * 3, 2.5cm) {};
	\node[boundingbox, fit=(sched4)(sched-label)(mark0)(mark1)] (sched) {};

	\node[right=10mm] (scalar-label) at (-1cm, 0cm) {Scalar};
	\foreach \s in {0,...,3}{
		\node[scalarbox, fill=color\s] (scalar\s) at (-1cm + 0.25cm * \s, -1cm - 0.25cm * \s) {};
	}

	\node[scalarbox, dotted, fill=color0!30!white, scope fading=south, minimum height=0.5cm] (scalar0-2) at (-1cm, -1.75cm) {};
	\node[scalarbox, dotted, fill=color1!30!white, scope fading=south, minimum height=0.5cm] (scalar1-2) at (-0.75cm, -2cm) {};
	\node[scalarbox, dotted, fill=color2!30!white, scope fading=south, minimum height=0.25cm] (scalar2-2) at (-0.5cm, -2.125cm) {};

	\node[right=10mm] (mark2) at (-1cm, -2.15cm) {};
	\node[boundingbox, fit=(scalar0)(scalar1)(mark2)(scalar-label)] (scalar) {};

	\foreach \s in {0,...,3}{
		\node[right=10mm] (simd-label\s) at (1.5cm + 3cm * \s, 0cm) {SIMD};
		\foreach \x in {0,...,3}{
			\node[simdbox, fill=color\s, text=textcolor\s] (lanes\x\s) at (1cm + 3cm * \s + 0.6cm * \x, -1cm - 0.25cm * \x) {\tiny 16};
		}

		\node[simdbox, dotted, fill=color\s!30!white, scope fading=south, minimum height=0.5cm]
			(lanes0-2\s) at (1cm + 3cm * \s + 0.6cm * 0, -1.75cm - 0.25cm * 0) {};
		\node[simdbox, dotted, fill=color\s!30!white, scope fading=south, minimum height=0.5cm]
			(lanes1-2\s) at (1cm + 3cm * \s + 0.6cm * 1, -1.75cm - 0.25cm * 1) {};
		\node[simdbox, dotted, fill=color\s!30!white, scope fading=south, minimum height=0.25cm]
			(lanes2-2\s) at (1cm + 3cm * \s + 0.6cm * 2, -1.625cm - 0.25cm * 2) {};

		\node (mark3\s) at (4.3cm + 3cm * \s, -2.15cm) {};
		\node[boundingbox, fit=(lanes0\s)(lanes3\s)(mark3\s)(simd-label\s)] (simd\s) {};
	}
\end{tikzpicture}
\end{center}
\caption{The scalar unit, SIMD units and scheduler of one compute unit in the AMD GCN architecture}
\label{fig:gpu-scalar}
\end{figure}
